<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marcapasos del Opositor - ITIC Academy</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container" id="app-container">
        <!-- Header -->
        <header class="header">
            <a href="https://itic.academy" target="_blank" class="logo">
                <img src="logo.jpeg" alt="ITIC Academy" class="logo-img">
                <span class="logo-text">Marcapasos del Opositor</span>
            </a>
            <div class="header-actions">
                <button class="btn-icon" id="btn-sound" title="Sonido activado">
                    <span id="sound-icon">&#128266;</span>
                </button>
                <button class="btn-icon" id="btn-settings" title="Configuracion">
                    &#9881;
                </button>
            </div>
        </header>

        <!-- Pantalla 1: Configuracion Inicial -->
        <main class="screen" id="config-screen">
            <div class="config-container">
                <h1>Configura tu Examen</h1>
                <p class="subtitle">Gestiona tu tiempo estrategicamente</p>

                <!-- Seccion: Tiempo Total -->
                <div class="config-section">
                    <h3><span class="section-number">1</span> Tiempo Total del Examen</h3>
                    <div class="time-selector">
                        <button class="time-option" data-minutes="60">1h</button>
                        <button class="time-option" data-minutes="180">3h</button>
                        <button class="time-option active" data-minutes="240">4h</button>
                        <button class="time-option" data-minutes="300">5h</button>
                        <div class="custom-time">
                            <input type="number" id="custom-minutes" placeholder="Min" min="30" max="480">
                            <span>minutos</span>
                        </div>
                    </div>
                    <div class="total-time-display">
                        Tiempo total: <strong id="total-time-display">4 horas (240 min)</strong>
                    </div>
                </div>

                <!-- Seccion: Bloques/Preguntas -->
                <div class="config-section">
                    <h3><span class="section-number">2</span> Define tus Bloques</h3>
                    <div class="blocks-header">
                        <span>Arrastra para reordenar prioridad</span>
                        <button class="btn-small" id="btn-add-block">+ Anadir Bloque</button>
                    </div>
                    <div class="blocks-list" id="blocks-list">
                        <!-- Bloques dinamicos -->
                    </div>
                    <div class="blocks-summary">
                        <div class="summary-bar">
                            <div class="summary-fill" id="summary-fill"></div>
                        </div>
                        <div class="summary-text">
                            <span id="total-percentage">0%</span> asignado
                            <span class="summary-warning hidden" id="percentage-warning">&#9888; Debe sumar 100%</span>
                        </div>
                    </div>
                </div>

                <!-- Seccion: Opciones Avanzadas -->
                <div class="config-section collapsible">
                    <h3 class="collapsible-header" id="advanced-toggle">
                        <span class="section-number">3</span>
                        Opciones Avanzadas
                        <span class="collapse-icon">&#9660;</span>
                    </h3>
                    <div class="collapsible-content hidden" id="advanced-options">
                        <div class="option-group">
                            <label class="option-label">
                                <input type="checkbox" id="opt-biometric" checked>
                                <span class="checkmark"></span>
                                Entrenamiento biometrico (gong cada 15 min)
                            </label>
                            <label class="option-label">
                                <input type="checkbox" id="opt-halfway" checked>
                                <span class="checkmark"></span>
                                Alerta a mitad de cada bloque
                            </label>
                            <label class="option-label">
                                <input type="checkbox" id="opt-final-sprint" checked>
                                <span class="checkmark"></span>
                                Aviso "Sprint Final" (ultimos 30 min)
                            </label>
                        </div>
                        <div class="option-group">
                            <label>Tiempo de aviso antes de fin de bloque:</label>
                            <select id="warning-time">
                                <option value="3">3 minutos</option>
                                <option value="5" selected>5 minutos</option>
                                <option value="10">10 minutos</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Plantillas Rapidas -->
                <div class="templates-section">
                    <h4>Plantillas Rapidas</h4>
                    <div class="templates-grid">
                        <button class="template-btn" data-template="a1">
                            <span class="template-icon">&#128221;</span>
                            <span>TIC A1</span>
                            <span class="template-desc">10 preguntas</span>
                        </button>
                        <button class="template-btn" data-template="a2">
                            <span class="template-icon">&#128187;</span>
                            <span>TIC A2</span>
                            <span class="template-desc">5 preguntas</span>
                        </button>
                        <button class="template-btn" data-template="informe">
                            <span class="template-icon">&#128196;</span>
                            <span>Informe Ejecutivo</span>
                            <span class="template-desc">5 bloques</span>
                        </button>
                        <button class="template-btn" data-template="balanced">
                            <span class="template-icon">&#9878;</span>
                            <span>Personalizado</span>
                            <span class="template-desc">En blanco</span>
                        </button>
                    </div>
                </div>

                <!-- Boton Iniciar -->
                <button class="btn-start" id="btn-start" disabled>
                    <span class="btn-start-icon">&#9654;</span>
                    Iniciar Examen
                </button>
            </div>
        </main>

        <!-- Pantalla 2: Examen en Curso -->
        <main class="screen hidden" id="exam-screen">
            <div class="exam-container">
                <!-- Reloj Principal -->
                <div class="main-clock">
                    <div class="clock-label">TIEMPO TOTAL RESTANTE</div>
                    <div class="clock-time" id="main-timer">04:00:00</div>
                    <div class="clock-progress">
                        <div class="clock-progress-fill" id="main-progress"></div>
                    </div>
                </div>

                <!-- Bloque Actual -->
                <div class="current-block" id="current-block">
                    <div class="block-header">
                        <div class="block-number" id="block-number">1</div>
                        <div class="block-info">
                            <div class="block-name" id="block-name">Pregunta 1</div>
                            <div class="block-meta">
                                <span id="block-allocated">48 min asignados</span>
                                <span class="separator">|</span>
                                <span id="block-percentage">20%</span>
                            </div>
                        </div>
                    </div>
                    <div class="block-timer-container">
                        <div class="block-timer" id="block-timer">48:00</div>
                        <div class="block-timer-label">para este bloque</div>
                    </div>
                    <div class="block-progress">
                        <div class="block-progress-fill" id="block-progress"></div>
                    </div>
                </div>

                <!-- Indicador de Estado (Semaforo) -->
                <div class="status-indicator" id="status-indicator">
                    <div class="status-light green active" id="light-green"></div>
                    <div class="status-light yellow" id="light-yellow"></div>
                    <div class="status-light red" id="light-red"></div>
                    <div class="status-text" id="status-text">Todo bajo control</div>
                </div>

                <!-- Navegacion de Bloques -->
                <div class="blocks-navigation">
                    <div class="blocks-nav-title">Progreso del Examen</div>
                    <div class="blocks-nav-grid" id="blocks-nav-grid">
                        <!-- Dinamico -->
                    </div>
                </div>

                <!-- Controles -->
                <div class="exam-controls">
                    <button class="btn-control btn-pause" id="btn-pause">
                        <span class="btn-icon-large">&#10074;&#10074;</span>
                        <span>Pausar</span>
                    </button>
                    <button class="btn-control btn-next" id="btn-next">
                        <span class="btn-icon-large">&#9654;&#9654;</span>
                        <span>Siguiente</span>
                    </button>
                    <button class="btn-control btn-panic" id="btn-panic">
                        <span class="btn-icon-large">&#9888;</span>
                        <span>Me he retrasado</span>
                    </button>
                </div>

                <!-- Boton Finalizar -->
                <button class="btn-finish" id="btn-finish">
                    Finalizar Examen
                </button>
            </div>
        </main>

        <!-- Pantalla 3: Panico / Recalculo -->
        <div class="modal hidden" id="panic-modal">
            <div class="modal-content panic-content">
                <div class="panic-header">
                    <span class="panic-icon">&#9888;</span>
                    <h2>Modo Rescate Activado</h2>
                </div>
                <p class="panic-message">
                    Tranquilo. Vamos a recalcular el tiempo restante para que puedas completar todas las preguntas.
                </p>
                <div class="panic-stats">
                    <div class="panic-stat">
                        <span class="stat-label">Tiempo usado de mas:</span>
                        <span class="stat-value" id="panic-overtime">+12 min</span>
                    </div>
                    <div class="panic-stat">
                        <span class="stat-label">Bloques restantes:</span>
                        <span class="stat-value" id="panic-remaining-blocks">3</span>
                    </div>
                </div>
                <div class="panic-options">
                    <label class="panic-option">
                        <input type="radio" name="recalc-mode" value="proportional" checked>
                        <span class="option-content">
                            <strong>Recorte proporcional</strong>
                            <span>Reducir tiempo de todos los bloques restantes</span>
                        </span>
                    </label>
                    <label class="panic-option">
                        <input type="radio" name="recalc-mode" value="last">
                        <span class="option-content">
                            <strong>Sacrificar el repaso</strong>
                            <span>Mantener bloques, eliminar tiempo de repaso</span>
                        </span>
                    </label>
                </div>
                <div class="panic-preview" id="panic-preview">
                    <!-- Preview dinamico -->
                </div>
                <div class="panic-actions">
                    <button class="btn-secondary" id="btn-panic-cancel">Cancelar</button>
                    <button class="btn-primary" id="btn-panic-confirm">Aplicar Recalculo</button>
                </div>
            </div>
        </div>

        <!-- Pantalla 4: Resultados -->
        <main class="screen hidden" id="results-screen">
            <div class="results-container">
                <div class="results-header">
                    <div class="results-icon">&#127942;</div>
                    <h1>Examen Completado</h1>
                </div>

                <div class="results-summary">
                    <div class="result-card">
                        <div class="result-icon">&#9201;</div>
                        <div class="result-value" id="result-total-time">3:45:22</div>
                        <div class="result-label">Tiempo Total</div>
                    </div>
                    <div class="result-card">
                        <div class="result-icon">&#9989;</div>
                        <div class="result-value" id="result-completed">5/5</div>
                        <div class="result-label">Bloques Completados</div>
                    </div>
                    <div class="result-card">
                        <div class="result-icon">&#9888;</div>
                        <div class="result-value" id="result-panics">1</div>
                        <div class="result-label">Recalculos</div>
                    </div>
                </div>

                <div class="results-breakdown">
                    <h3>Desglose por Bloque</h3>
                    <div class="breakdown-list" id="breakdown-list">
                        <!-- Dinamico -->
                    </div>
                </div>

                <div class="results-tips">
                    <h3>Consejos para Mejorar</h3>
                    <div class="tips-list" id="tips-list">
                        <!-- Dinamico -->
                    </div>
                </div>

                <div class="results-actions">
                    <button class="btn-primary btn-large" id="btn-new-exam">
                        Nuevo Examen
                    </button>
                    <button class="btn-secondary" id="btn-export-results">
                        Exportar Resultados
                    </button>
                </div>
            </div>
        </main>

        <!-- Modal de Configuracion -->
        <div class="modal hidden" id="settings-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Configuracion</h2>
                    <button class="btn-close" id="btn-close-settings">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="settings-group">
                        <h4>Sonidos</h4>
                        <label class="setting-option">
                            <span>Volumen de alertas</span>
                            <input type="range" id="volume-slider" min="0" max="100" value="70">
                        </label>
                        <label class="setting-option">
                            <span>Tipo de gong</span>
                            <select id="gong-type">
                                <option value="bell">Campana suave</option>
                                <option value="chime">Carrillon</option>
                                <option value="gong">Gong tibetano</option>
                                <option value="beep">Pitido discreto</option>
                            </select>
                        </label>
                    </div>
                    <div class="settings-group">
                        <h4>Visualizacion</h4>
                        <label class="setting-option">
                            <span>Tamano de reloj</span>
                            <select id="clock-size">
                                <option value="normal">Normal</option>
                                <option value="large">Grande</option>
                                <option value="compact">Compacto</option>
                            </select>
                        </label>
                    </div>
                    <div class="settings-group">
                        <h4>Datos</h4>
                        <button class="btn-secondary btn-full" id="btn-clear-data">
                            Borrar historial de examenes
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notificacion Toast -->
        <div class="toast hidden" id="toast">
            <span class="toast-icon"></span>
            <span class="toast-message"></span>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
